import pandas
from sklearn.model_selection import cross_val_score
from sklearn.model_selection import KFold
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score
from sklearn.preprocessing import scale

data = pandas.read_csv('data/wine.data', header=None)

X = data.loc[:,1:]
y = data[0]

cv = KFold(n_splits = 5, shuffle=True, random_state = 42)

scores = list()
for k in range(1,51):
    model = KNeighborsClassifier(k)
    scores.append(cross_val_score(model, X, y, cv = cv, scoring = 'accuracy'))
pandas.DataFrame(scores).mean(axis =1 ).sort_values(ascending = False).head(1)

X = scale(X)

scores = list()
for k in range(1,51):
    model = KNeighborsClassifier(k)
    scores.append(cross_val_score(model, X, y, cv = cv, scoring = 'accuracy'))
pandas.DataFrame(scores, range(1, 51)).mean(axis =1 ).sort_values(ascending = False).head(1)
